/*
 toastmasters 2014-11-25 
*/
var _fn={activeNav:function(a){return void 0!==a&&($("#main-nav li").removeClass("active"),$(a).addClass("active")),$("#main-nav li.active")},handleNavClick:function(){$("#main-nav.collapse:visible").collapse("hide")},elapsedMinutesAndSeconds:function(a,b){var c=Math.abs(b.getTime()-a.getTime()),d=new Date,e=new Date(0);d.setTime(c);var f=d.getMinutes()-e.getMinutes(),g=d.getSeconds()-e.getSeconds();return{minutes:f,seconds:g}},formatStamp:function(a){return a.seconds<10&&(a.seconds="0"+a.seconds),a.minutes+":"+a.seconds},startTiming:function(a,b){var c=$("#stop-btn");$("#current-timer-who").text(b),c.data("timer",a),$("#timer").addClass("timing"),tm.timing=!0;var d=new Date,e=function(){var a=new Date,b=_fn.elapsedMinutesAndSeconds(d,a),f=_fn.formatStamp(b);$("#current-timer-time").text(f),c.data("time",f),tm.timing&&setTimeout(e,1e3)};e()},stopTiming:function(){tm.timing=!1;var a=$(this);console.log(a.data("time")),$("#timer").removeClass("timing").removeClass("red").removeClass("yellow").removeClass("green")}},tm={timer_range:{one_two:{green:1,yellow:1.5,red:2},two_three:{green:2,yellow:2.5,red:3},five_seven:{green:5,yellow:6,red:7}},timing:!1};Ember.Handlebars.helper("elapsedTime",function(a,b){if(null!==a&&null!==b&&void 0!==a&&void 0!==b){var c=_fn.elapsedMinutesAndSeconds(a,b),d=c.minutes,e=c.seconds;return 10>e&&(e="0"+e),new Ember.Handlebars.SafeString(d+":"+e)}return new Ember.Handlebars.SafeString("0:00")}),$.getJSON("table-topics.json",function(a){window.Toastmasters=Ember.Application.create(),Toastmasters.ApplicationAdapter=DS.FixtureAdapter.extend(),Toastmasters.Router.map(function(){this.resource("home",{path:"/"}),this.resource("timer",{path:"/timer"}),this.route("refreshTableTopics",{path:"/tableTopics/refresh"}),this.resource("ahCounter",{path:"/ahCounter"}),this.resource("voteCounter",{path:"/voteCounter"}),this.resource("tableTopics",{path:"/tableTopics"}),this.resource("info",{path:"/info"})}),Toastmasters.Timer=DS.Model.extend({who:DS.attr("string"),start:DS.attr("date"),end:DS.attr("date"),green:DS.attr("number"),yellow:DS.attr("number"),red:DS.attr("number"),listGroupItemClass:function(){var a=this.get("start"),b=this.get("end"),c=this.get("red");if(null!==a&&null!==b&&void 0!==a&&void 0!==b){var d=_fn.elapsedMinutesAndSeconds(a,b).minutes;return new Handlebars.SafeString(d+.5>c?"list-group-item-danger":"list-group-item-success")}return new Handlebars.SafeString("")}.property("start","end","range")}),Toastmasters.AhCounter=DS.Model.extend({who:DS.attr("string"),ahCount:DS.attr("number"),crutchCount:DS.attr("number"),wotdCount:DS.attr("number")}),Toastmasters.Vote=DS.Model.extend({who:DS.attr("string"),count:DS.attr("number")}),Toastmasters.TableTopic=DS.Model.extend({question:DS.attr("string")}),Toastmasters.HomeRoute=Ember.Route.extend({activate:function(){_fn.activeNav(".navbar-brand")}}),Toastmasters.Timer.FIXTURES=[{id:1,who:"Judy",start:null,end:null,green:tm.timer_range.five_seven.green,yellow:tm.timer_range.five_seven.yellow,red:tm.timer_range.five_seven.red},{id:2,who:"Steve",start:new Date("2014","11","22","14","22","01"),end:new Date("2014","11","22","14","29","04"),green:tm.timer_range.five_seven.green,yellow:tm.timer_range.five_seven.yellow,red:tm.timer_range.five_seven.red},{id:3,who:"Dave",start:new Date("2014","11","22","14","22","01"),end:new Date("2014","11","22","14","23","27"),green:tm.timer_range.one_two.green,yellow:tm.timer_range.one_two.yellow,red:tm.timer_range.one_two.red}],Toastmasters.TimerRoute=Ember.Route.extend({activate:function(){_fn.activeNav("#timer-nav")},model:function(){return this.store.find("timer")}}),Toastmasters.AhCounter.FIXTURES=[],Toastmasters.AhCounterRoute=Ember.Route.extend({activate:function(){_fn.activeNav("#ah-counter-nav")},model:function(){return this.store.find("ahCounter")}}),Toastmasters.Vote.FIXTURES=[],Toastmasters.VoteCounterRoute=Ember.Route.extend({activate:function(){_fn.activeNav("#vote-counter-nav")},model:function(){return this.store.find("vote")}}),Toastmasters.TableTopic.FIXTURES=a.tableTopics,Toastmasters.TableTopicsRoute=Ember.Route.extend({activate:function(){_fn.activeNav("#table-topics-nav")},model:function(){return this.store.find("tableTopic",Math.floor(Math.random()*(1-a.tableTopics.length)+a.tableTopics.length))}}),Toastmasters.RefreshTableTopicsRoute=Ember.Route.extend({activate:function(){this.transitionTo("tableTopics")}}),Toastmasters.InfoRoute=Ember.Route.extend({activate:function(){_fn.activeNav("#info-nav")}})}),$(document).on("ready",function(){$(document).on("click",_fn.handleNavClick).on("click",".start-btn:visible",function(){var a=$(this);_fn.startTiming(a.attr("id"),a.data("name"))}).on("click","#stop-btn",_fn.stopTiming)});